(this["webpackJsonpladybird-ui"]=this["webpackJsonpladybird-ui"]||[]).push([[0],{105:function(e,t,a){e.exports=a.p+"static/media/logo.83c07097.png"},123:function(e,t,a){e.exports=a(169)},169:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(17),i=a.n(o),c=a(85),s=a(37),l=a(65),m=a.n(l),u=a(26),g=a(103),h=a.n(g),p=a(203),d=a(196),f=a(104),b=a.n(f),v=a(116),E=a(105),y=a.n(E),w=m()((function(e){return{logo:{maxHeight:"calc(112px + 1vmin)"}}})),x=function(){var e=w();return r.a.createElement(d.a,null,r.a.createElement("div",null,r.a.createElement("a",{href:"https://www.rctech.club",rel:"noopener noreferrer"},r.a.createElement("img",{className:e.logo,src:y.a,alt:"RCTECH"}))))},k=a(90),j=a(64),O=a(55),S=a(28),T=a(20),R=function(e){return function(t){var a=Object(n.useState)(),o=Object(u.a)(a,2),i=o[0],c=o[1],s=new j.a({uri:"https://phoenix.rctech.club/graphql",headers:{authorization:i?i.getAuthResponse().id_token:""}}),l=new O.a,m=new S.a({cache:l,link:s});return r.a.createElement(T.a,{client:m},r.a.createElement(e,Object.assign({googleUser:i,setGoogleUser:c,clientID:"798725565697-sfibjdadpcan9ks908dnl8p5k1dncmoq.apps.googleusercontent.com"},t)))}},C=a(54),_=a(73),F=a(56);function I(){var e=Object(_.a)(["\n  mutation Login {\n    login {\n      token\n      login_status\n      register\n    }\n  }\n"]);return I=function(){return e},e}var P=Object(F.a)(I()),W=a(202),U=a(208),A=a(201),L=a(199),N=a(200),$=a(198),z=a(197),q=r.a.forwardRef((function(e,t){return r.a.createElement(z.a,Object.assign({direction:"up",ref:t},e))})),G=function(e){var t=e.isOpen,a=r.a.useState(t),n=Object(u.a)(a,2),o=n[0],i=n[1];return r.a.createElement("div",null,r.a.createElement(U.a,{open:o,TransitionComponent:q,keepMounted:!0,"aria-labelledby":"cookies-agreement","aria-describedby":"cookies-agreement-description"},r.a.createElement($.a,{id:"cookies-agreement"},"Allow RC Tech to store cookies?"),r.a.createElement(L.a,null,r.a.createElement(N.a,{id:"cookies-agreement-description"},"Let us store cookies in your browser so that you can enjoy a smooth personal experience logging into and using all of our applications.")),r.a.createElement(A.a,null,r.a.createElement(W.a,{onClick:function(){if(alert("We need your consent to provide our authentication services. You may contact RC Tech Club to find out more why this is important. You will now be redirected back to where you came from if possible."),""!==sessionStorage.getItem("redirectTo")){var e="https://".concat(sessionStorage.getItem("redirectTo"));window.location.replace(e)}},color:"primary"},"Disagree"),r.a.createElement(W.a,{onClick:function(){i(!1)},color:"primary"},"Agree"))))},H=Object(p.a)((function(e){return{container:{margin:"3vh auto"},text:{margin:"4vh"},redirect:{margin:"40px auto"}}})),B=R((function(e){e.googleUser;var t=e.setGoogleUser,a=e.clientID,o=e.location,i=e.history,c=H(),s=Object(n.useState)(!1),l=Object(u.a)(s,2),m=l[0],g=l[1],p=Object(C.a)(P),f=Object(u.a)(p,1)[0],E=new v.a,y=E.get("RCTC_USER"),w=!y&&""!==y;console.log("production"),""!==sessionStorage.getItem("redirectTo")&&null!==sessionStorage.getItem("redirectTo")||sessionStorage.setItem("redirectTo",b.a.parse(o.search).redirectTo||"");return r.a.createElement(d.a,{className:c.container},r.a.createElement(x,null),r.a.createElement("div",null,r.a.createElement(k.a,{variant:"h2"},"Login")),r.a.createElement("div",{className:c.text},r.a.createElement(k.a,{variant:"h3"},"Welcome RC Lee Hall mate!"),r.a.createElement(k.a,{variant:"h5"},"To continue using our app, please sign in using your HKU account.")),r.a.createElement(h.a,{onSuccess:function(e){console.log(e),t(e),f().then((function(t){var a=t.data.login,n=a.token,r=a.login_status,o=a.register;if(r){E.set("RCTC_USER",n,{path:"/",domain:".rctech.club"}),sessionStorage.getItem("redirectTo").length>0&&window.location.replace("https://".concat(sessionStorage.getItem("redirectTo"),"?id=").concat(n))}if(o){var c=function(){var e=window.gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile();return{id:e.getId(),first_name:e.getGivenName(),last_name:e.getFamilyName(),image_url:e.getImageUrl(),email_id:e.getEmail()}}();i.push({pathname:"register",state:{user:c,googleUserLogin:e,token:e.getAuthResponse().id_token}})}})).catch((function(e){console.log(e),alert("There was an error logging you in")}))},onRequest:function(){g(!0)},onFailure:function(){alert("Failed Google Login. Please try again.")},clientId:a,disabled:m,cookiePolicy:"single_host_origin"}),r.a.createElement("div",{className:c.redirect},""!==sessionStorage.getItem("redirectTo")?r.a.createElement(k.a,{variant:"body1"},"If you keep coming back here after login, please"," ",r.a.createElement("a",{href:"https://".concat(sessionStorage.getItem("redirectTo"))},"click here")):r.a.createElement(k.a,{variant:"body1"},"Please re-visit the application that redirected you here. We apologize for losing that information.")),r.a.createElement(G,{isOpen:w}))})),Y=a(86),D=a.n(Y),J=a(113),K=a(204),M=a(213),Q=a(211),V=a(210),X=a(205),Z=a(206),ee=a(209);function te(){var e=Object(_.a)(["\n  mutation Register($username: String!, $phone: String!, $room_no: String!) {\n    register(user: { username: $username, phone: $phone, room_no: $room_no }) {\n      username\n    }\n  }\n"]);return te=function(){return e},e}var ae=Object(F.a)(te()),ne=Object(p.a)({container:{margin:"3vh auto"},disclaimer:{margin:"2vh auto",textAlign:"left"},form:{margin:"2vh auto"}}),re=R((function(e){var t=e.setGoogleUser,a=e.location,o=e.history,i=ne(),c=Object(n.useState)(!1),l=Object(u.a)(c,2),m=l[0],g=l[1],h=Object(n.useState)({}),p=Object(u.a)(h,2),f=p[0],b=p[1],v=Object(C.a)(ae),E=Object(u.a)(v,2),y=E[0],w=E[1].error;Object(n.useEffect)((function(){a.state&&a.state.googleUserLogin&&t(a.state.googleUserLogin),w&&(alert("There was an error completing registration. Please register again."),o.replace({location:"/"}))}),[w,a,o,t]);var x=function(e){for(var t=function(e){return!e||""===e},a=0,n=[{id:"username",method:function(e){return RegExp("^[0-9A-z]{4,20}$").test(e)}},{id:"phone",method:function(e){return RegExp("^[0-9]{8}$").test(e)}},{id:"room_no",name:"room number",method:function(e){return RegExp("^[1-9][0-9]{2,3}([A,B])?$").test(e)}}];a<n.length;a++){var r=n[a],o=e[r.id];if(t(o)||!r.method(o))return{validation:!1,message:"Your ".concat(r.name||r.id," of ").concat(o," is not accepted.")}}return m?{validation:!0}:{validation:!1,message:"You need to agree to our privacy terms."}},j=function(e){f[e.target.id]=e.target.value,b(f)},O=function(){var e=Object(J.a)(D.a.mark((function e(){var t,a,n,r,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x(f),a=t.validation,n=t.message,!a){e.next=16;break}return e.prev=2,e.next=5,y({variables:f});case 5:r=e.sent,(i=r.data)&&i.register&&i.register.username?(alert("Registration complete! Login again to continue"),o.replace({location:"/"})):(alert("There was an error with registration. Please try again."),o.replace({location:"/"})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),alert("There was an error with registration. Please try again"),o.replace({location:"/"});case 14:e.next=17;break;case 16:alert(n);case 17:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();if(void 0===a.state)return r.a.createElement(s.a,{to:"/"});var S=a.state.user;return r.a.createElement(d.a,{className:i.container},r.a.createElement(k.a,{variant:"h3"},"Hello, ".concat(S.first_name)),r.a.createElement(K.a,{className:i.form},r.a.createElement(M.a,{required:!0},r.a.createElement(Q.a,{htmlFor:"username"},"Username"),r.a.createElement(V.a,{id:"username","aria-describedby":"username-helper-text",onChange:j,inputProps:{maxLength:20}}),r.a.createElement(X.a,{id:"username-helper-text"},"For example: iamawesome. Only alphanumeric characters are allowed with a minimum length of 4 and a maximum length of 20.")),r.a.createElement(M.a,{required:!0},r.a.createElement(Q.a,{htmlFor:"phone"},"Phone (Hong Kong)"),r.a.createElement(V.a,{id:"phone","aria-describedby":"phone-helper-text",onChange:j,type:"number",inputProps:{maxLength:8}}),r.a.createElement(X.a,{id:"phone-helper-text"},"For example: 12345678")),r.a.createElement(M.a,{required:!0},r.a.createElement(Q.a,{htmlFor:"room_no"},"Room number"),r.a.createElement(V.a,{id:"room_no","aria-describedby":"room-helper-text",onChange:j,inputProps:{maxLength:5}}),r.a.createElement(X.a,{id:"room-helper-text"},"For example: 924A")),r.a.createElement("div",{className:i.disclaimer},r.a.createElement(k.a,{variant:"h5"},"Privacy Agreement"),r.a.createElement(k.a,{variant:"body1"},"To continue using our services, we require you to sign in with Google, in which you have successfully completed that step. While we implicitly have access to your Google account information, other important details such as your room number are needed to deliver the best user experience. We will not share your personal data with any other 3rd party applications and services."),r.a.createElement("br",null),r.a.createElement(Z.a,{control:r.a.createElement(ee.a,{checked:m,onChange:function(){return g(!m)},name:"privacyAgreement",color:"primary"}),label:"I agree to the privacy agreement."})),r.a.createElement(W.a,{type:"submit",onClick:O},"Submit")))})),oe=m()((function(e){return{container:{textAlign:"center",justifyContent:"center",margin:"auto"}}})),ie=function(){var e=oe();return r.a.createElement("div",{className:e.container},r.a.createElement(c.a,null,r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/",exact:!0,component:B}),r.a.createElement(s.b,{path:"/register",exact:!0,component:re}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ce=a(212),se=a(115),le=Object(ce.a)(Object(se.a)({palette:{primary:{light:"#727394",main:"#464866",dark:"#1d213b"},secondary:{main:"#ef9a9a"},background:{default:"#fff"},error:{main:"#B00020"},user:{main:"#ce93d8"},others:{main:"#9fa8da"}},typography:{h1:{fontFamily:"Poppins, sans-serif",fontWeight:200,fontSize:"4em",margin:"20px 0"},h2:{fontFamily:"Poppins, sans-serif",fontWeight:200,margin:"20px 0",fontSize:"3em"},h3:{fontFamily:"Poppins, sans-serif",fontWeight:200,fontSize:"2em",margin:"20px 0"},h4:{fontFamily:"Poppins, sans-serif",fontWeight:200,margin:"20px 0"},h5:{fontFamily:"Poppins, sans-serif",fontWeight:200,fontSize:"1em"},h6:{fontFamily:"Roboto, sans-serif",fontWeight:400,fontSize:"1em"},subtitle1:{fontFamily:"Roboto, sans-serif",fontWeight:600},subtitle2:{fontFamily:"Roboto, sans-serif",fontWeight:200},button:{fontFamily:"Poppins, sans-serif",fontWeight:300}}})),me=a(195),ue=a(207);i.a.render(r.a.createElement(me.a,{theme:le},r.a.createElement(ue.a,null),r.a.createElement(ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[123,1,2]]]);
//# sourceMappingURL=main.6bda5010.chunk.js.map